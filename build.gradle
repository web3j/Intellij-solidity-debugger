plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '0.6.5'
    id 'org.jetbrains.kotlin.jvm' version '1.4.30'
}

group 'org.web3j.evm.debugger'
version '1.0-SNAPSHOT'

ext {
    besuPluginVersion = '20.10.2'
    besuInternalVersion = '20.10.2'
    besuCryptoDepVersion = '0.3.0'
}

repositories {
    jcenter()
    mavenCentral()
    maven {
        url = uri("https://hyperledger-org.bintray.com/besu-repo/")
    }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['log4j-api-3.0.0-SNAPSHOT.jar'])

    implementation "com.beust:klaxon:5.0.1"
    implementation "org.jetbrains.kotlin:kotlin-stdlib:1.4.30"
    implementation "org.jetbrains.kotlin:kotlin-reflect:1.4.30"
    implementation "org.web3j:core:4.8.4"
    implementation "org.web3j:web3j-evm:4.8.5"

    implementation "org.hyperledger.besu:plugin-api:$besuPluginVersion"
    implementation "org.hyperledger.besu.internal:api:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:config:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:core:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:crypto:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:rlp:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:kvstore:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:metrics-core:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:trie:$besuInternalVersion"
    implementation "org.hyperledger.besu.internal:util:$besuInternalVersion"
    implementation "org.hyperledger.besu:bls12-381:$besuCryptoDepVersion"
    implementation 'org.mockito:mockito-core:3.8.0'
    testImplementation("org.junit.jupiter:junit-jupiter:5.7.0")
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
    testImplementation group: 'org.jetbrains.kotlin', name: 'kotlin-test-junit', version: '1.5.0-M1'

}

configurations {
    all {
        //exclude group:"org.slf4j", module:"slf4j-api"
        //exclude group:"org.apache.logging.log4j", module:"slf4j-to-log4j12"
        //exclude group:"org.apache.logging.log4j", module:"log4j-api"
    }

}

// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    version '2020.3.2'
    dependencies {
        compileOnly fileTree(dir: 'libs', include: ['intellij-solidity-2.3.2-SNAPSHOT.jar'])
    }
    plugins = [
            'java', //Required for com.intellij.execution.CommonJavaRunConfigurationParameters
            'me.serce.solidity:2.3.1',
    ]
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}


patchPluginXml {
    changeNotes """
      Add change notes here.<br>
      <em>most HTML tags may be used</em>"""
}
test {
    useJUnitPlatform()
}

tasks.withType(Test) {
    useJUnitPlatform()

}
